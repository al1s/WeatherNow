{"version":3,"sources":["script.js"],"names":["createCookie","name","value","days","Date","setTime","date","getTime","toGMTString","document","expires","readCookie","RegExp","replace","exec","cookie","eraseCookie","getWeatherColor","temp_c","colors","main","support","getWeatherImage","conditions","seasonYear","credits","snow","URL","license","licenseURL","author","winter","spring","summer","fall","backgroundImage","credit","flurries","fog","hazy","rain","sunny","cloudy","mostlysunny","partlysunny","aboutElm","querySelector","dateElm","fScaleClickHandler","e","type","keyCode","innerText","tempElm","data","toggleButtonsState","tempFScaleLabelElm","tempCScaleLabelElm","btn_pressed","addHandler","cScaleClickHandler","removeHandler","inputCheckedElm","tempFScaleInputElm","inputUncheckedElm","tempCScaleInputElm","btn_released","setAttribute","removeEventListener","classList","addEventListener","add","getWeatherForPosition","httpAddr","remove","fetch","json","placeElm","skyElm","copyrightElm","copyrightTextElm","userScale","currDate","currTime","hemisphere","timeElm","currMonth","temp_f","bgImage","weatherColors","setProperty","documentElement","mainElm","style","color","backgroundColor","aboutCloseBtnElm","borderColor","aboutBtnElm","bodyElm","image","innerHTML","loc","display_location","place","pos","time","obz","local_epoch","d","setUTCSeconds","then","dayOptions","dateOptions","day","resp","minute","Error","getMonth","weather","country","state","state_name","tempFeels","feelslike_string","tempFeelsC","tempFeelsF","feelslike_f","month","hour","currDay","toLocaleDateString","undefined","toLocaleTimeString","timeOptions","sky","temp","temperature_string","feelslike_c","displayData","getLocationByIP","geoLocFail","error","msg","console","log","ok","latitude","longitude","warn","getLocation","navigator","location_timeout","err","message","timeout","setTimeout","maximumAge","code","geolocation","getCurrentPosition","position","clearTimeout","coords","aboutBtn","aboutMsg","enableHighAccuracy","toggle","aboutCloseBtn"],"mappings":"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","file":"script.js","sourcesContent":["  function createCookie(name,value,days) {\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime()+(days*24*60*60*1000));\n      var expires = '; expires='+date.toGMTString();\n    } else var expires = '';\n    document.cookie = name+'='+value+expires+'; path=/';\n  }\n\n//here is the function from https://stackoverflow.com/a/5882352\n  function readCookie(name) {\n    return (name = new RegExp('(?:^|;\\\\s*)' + ('' + name).replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&') + '=([^;]*)').exec(document.cookie)) && name[1];\n  }\n\n  function eraseCookie(name) {\n    createCookie(name, '', -1);\n  }\n\n  function getWeatherColor(temp_c) {\n    let colors = {};\n    if (30 <= temp_c) colors = { main: '#A50021', support: '#fff'};\n    else if (25 <= temp_c && temp_c < 30) colors = { main: '#D82632', support: '#fff'};\n    else if (20 <= temp_c && temp_c < 25) colors = { main: '#F76D5E', support: '#242442'}; //support: #fff - bad accessibility\n    else if (15 <= temp_c && temp_c < 20) colors = { main: '#FFAD72', support: '#00365c'};\n    else if (10 <= temp_c && temp_c < 15) colors = { main: '#FFE099', support: '#001F66'};\n    else if (5 <= temp_c && temp_c < 10) colors = { main: '#FFFFBF', support: '#000040'};\n    else if (0 <= temp_c && temp_c < 5) colors = { main: '#E0FFFF', support: '#1F0000'};\n    else if (-5 <= temp_c && temp_c < 0) colors = { main: '#AAF7FF', support: '#1F0000'};\n    else if (-10 <= temp_c && temp_c < -5) colors = { main: '#72D8FF', support: '#1F0000'};\n    else if (-15 <= temp_c && temp_c < -10) colors = { main: '#3FA0FF', support: '#1F0000'};\n    else if (-20 <= temp_c && temp_c < -15) colors = { main: '#264CFF', support: '#fcc'};\n    return colors;\n  }\n\n  function getWeatherImage(conditions, seasonYear) {\n    // weather determitants:\n    // - conditions as returned by weather API\n    // - current local season of the year;\n    // - latitude (north or south hemisphere);\n    let backgroundImage;\n    let credit = {};\n    let credits = {\n      flurries:    { author: 'Frida',\n                       URL: 'https://flic.kr/p/k7zUGc',\n                    license: 'CC BY-NC 2.0',\n                 licenseURL: 'https://creativecommons.org/licenses/by-nc/2.0' },\n      snow:        { author: 'FHKE',\n                       URL: 'https://flic.kr/p/7AVLQR',\n                    license: 'CC BY-SA 2.0',\n                 licenseURL: 'https://creativecommons.org/licenses/by-sa/2.0' },\n      storm:       { author: 'Kuster & Wildhaber Photography',\n                       URL: 'https://flic.kr/p/cESNRS',\n                    license: 'CC BY-ND 2.0',\n                 licenseURL: 'https://creativecommons.org/licenses/by-nd/2.0' },\n      fog:         { author: 'Martin Fisch',\n                       URL: 'https://flic.kr/p/dkqP1t',\n                    license: 'CC BY-SA 2.0',\n                 licenseURL: 'https://creativecommons.org/licenses/by-sa/2.0' },\n      hazy:        { author: 'pnwbot',\n                       URL: 'https://flic.kr/p/pusoD1',\n                    license: 'CC BY-NC-SA 2.0',\n                 licenseURL: 'https://creativecommons.org/licenses/by-nc-sa/2.0' },\n      rain:        { author: 'Gabriele Diwald',\n                       URL: 'https://flic.kr/p/dfkuTL',\n                    license: 'CC BY 2.0',\n                 licenseURL: 'https://creativecommons.org/licenses/by/2.0'},\n      sunny:       { winter: { author: 'bfatphoto',\n                                 URL: 'https://flic.kr/p/RHwJiG',\n                              license: 'CC BY-NC-ND 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-nc-nd/2.0' },\n                    spring:  { author: 'Stanley Zimny',\n                                 URL: 'https://flic.kr/p/oavqBk',\n                              license: 'CC BY-NC 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-nc/2.0' },\n                    summer:  { author: 'Chris',\n                                 URL: 'https://flic.kr/p/fgLTUU',\n                              license: 'CC BY-SA 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-sa/2.0'},\n                    fall:    { author: 'Jorge Franganillo',\n                                 URL: 'https://flic.kr/p/i28UqP',\n                              license: 'CC BY 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by/2.0' }},\n      cloudy:      { summer: { author: 'Kay Gaensler',\n                                 URL: 'https://flic.kr/p/cScQxy',\n                              license: 'CC BY-NC-SA 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-nc-sa/2.0' },\n                     winter: { author: 'Peter Toporowski',\n                                 URL: 'https://flic.kr/p/RDW4Z1',\n                              license: 'CC BY 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by/2.0' }},\n      partlysunny: { winter: { author: 'GÃ©rald Laik',\n                                 URL: 'https://flic.kr/p/RzuZS7',\n                              license: 'CC BY-NC-ND 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-nc-nd/2.0' },\n                    spring:  { author: 'Graham Haley',\n                                 URL: 'https://flic.kr/p/UtjTDm',\n                              license: 'CC BY-SA 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-sa/2.0' },\n                    summer:  { author: 'Nicolas Raymond',\n                                  URL: 'http://freestock.ca/skies_clouds_g61-coastal_clouds__hdr_p1879.html',\n                              license: 'CC BY 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by/2.0'}},\n     mostlysunny:  { winter: { author: 'Adam Tas',\n                                 URL: 'https://flic.kr/p/R33zcf',\n                              license: 'CC BY 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by/2.0' },\n                    spring:  { author: 'Jim Choate',\n                                 URL: 'https://flic.kr/p/SbmJj2',\n                              license: 'CC BY-NC-ND 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by-nc-nd/2.0' },\n                    summer:  { author: 'Nicolas Raymond',\n                                 URL: 'http://freestock.ca/canada_g92-beaver_brook_scenery__hdr_p804.html',\n                              license: 'CC BY 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by/2.0' },\n                    fall:    { author: 'Belinda Church',\n                                 URL: 'https://flic.kr/p/qb4cbs',\n                              license: 'CC BY 2.0',\n                           licenseURL: 'https://creativecommons.org/licenses/by/2.0' }}\n    };\n    switch (conditions) {\n      case 'chanceflurries':\n      case 'chancesleet':\n      case 'flurries':\n      case 'sleet':\n        backgroundImage = `img/flurries.jpg`;\n        credit = credits.flurries;\n        break;\n      case 'chancesnow':\n      case 'snow':\n        backgroundImage = `img/snow.jpg`;\n        credit = credits.snow;\n        break;\n      case 'chancetstorms':\n      case 'tstorms':\n        backgroundImage = `img/storm.jpg`;\n        credit = credits.storm;\n        break;\n      case 'fog':\n        backgroundImage = `img/fog.jpg`;\n        credit = credits.fog;\n        break;\n      case 'hazy':\n        backgroundImage = `img/hazy.jpg`;\n        credit = credits.hazy;\n        break;\n      case 'chancerain':\n      case 'rain':\n        backgroundImage = `img/rain.jpg`;\n        credit = credits.rain;\n        break;\n      case 'clear':\n      case 'sunny':\n        backgroundImage = `img/sunny_${seasonYear}.jpg`;\n        credit = credits.sunny[seasonYear];\n        break;\n      case 'cloudy':\n        if (seasonYear === 'spring' || seasonYear === 'fall') seasonYear = 'summer';\n        backgroundImage = `img/cloudy_${seasonYear}.jpg`;\n        credit = credits.cloudy[seasonYear];\n        break;\n      case 'mostlycloudy':\n      case 'partlysunny':\n        if (seasonYear === 'fall') seasonYear = 'spring';\n        backgroundImage = `img/partlysunny_${seasonYear}.jpg`;\n        credit = credits.partlysunny[seasonYear];\n        break;\n      case 'mostlysunny':\n      case 'partlycloudy':\n        backgroundImage = `img/mostlysunny_${seasonYear}.jpg`;\n        credit = credits.mostlysunny[seasonYear];\n        break;\n    }\n    return { image: backgroundImage, credit };\n  }\n\n  function displayData(data) {\n\n    const bodyElm = document.querySelector('body');\n    const mainElm = document.querySelector('.main');\n    const aboutElm = document.querySelector('.about');\n    const aboutBtnElm = document.querySelector('.about__button');\n    const aboutCloseBtnElm = document.querySelector('.about__button--close-modal');\n    const dateElm = document.querySelector('.geo-details__date');\n    const timeElm = document.querySelector('.geo-details__time');\n    const placeElm = document.querySelector('.geo-details__place');\n    const skyElm = document.querySelector('.weather__sky');\n    const tempElm = document.querySelector('.weather__temp');\n    const tempFScaleLabelElm = document.querySelector('.label__item--fahrenheit');\n    const tempCScaleLabelElm = document.querySelector('.label__item--celsius');\n    const tempFScaleInputElm = document.querySelector('.radio__item--fahrenheit');\n    const tempCScaleInputElm = document.querySelector('.radio__item--celsius');\n    const copyrightElm = document.querySelector('.copyright');\n    const copyrightTextElm = document.querySelector('.copyright__text');\n    //const copyrightSignElm = document.querySelector('.copyright__sign');\n    const userScale = readCookie('scale');\n\n\n    dateElm.innerText = data.currDate;\n    timeElm.innerText = data.currTime;\n    placeElm.innerText = data.place;\n    tempElm.innerText = userScale === 'celsius' ? data.temp_c : data.temp_f;\n\n    // set visual appearance of the page\n    let seasonYear;\n    if (data.currMonth < 3 || data.currMonth === 12) {\n      seasonYear = data.hemisphere === 'north' ? 'winter' : 'summer';\n    } else if (3 <= data.currMonth && data.currMonth < 6) {\n      seasonYear = data.hemisphere === 'north' ? 'spring' : 'fall';\n    } else if (6 <= data.currMonth && data.currMonth < 9) {\n      seasonYear = data.hemisphere === 'north' ? 'summer' : 'winter';\n    } else if (9 <= data.currMonth && data.currMonth < 12) {\n      seasonYear = data.hemisphere === 'north' ? 'fall' : 'spring';\n    }\n    const bgImage = getWeatherImage(data.conditions, seasonYear);\n    const weatherColors = getWeatherColor(data.temp_c); // all inner visual appearance decisions are based on celsius scale;\n    document.documentElement.style.setProperty('--bg-color', weatherColors.main);\n    document.documentElement.style.setProperty('--text-color', weatherColors.support);\n    // unable to set svg properties through css variables, so work directly\n    //copyrightSignElm.style.color = weatherColors.main;\n    //copyrightSignElm.style.fill = weatherColors.support;\n    // unable to rule colors in old Safari with css variables, so work directly\n    mainElm.style.color = weatherColors.support;\n    mainElm.style.backgroundColor = weatherColors.main;\n    aboutElm.style.color = weatherColors.support;\n    aboutElm.style.backgroundColor = weatherColors.main;\n    aboutElm.style.borderColor = weatherColors.support;\n    aboutBtnElm.style.color = weatherColors.support;\n    aboutBtnElm.style.backgroundColor = weatherColors.main;\n    aboutBtnElm.style.borderColor = weatherColors.support;\n    aboutCloseBtnElm.style.color = weatherColors.main;\n    aboutCloseBtnElm.style.backgroundColor = weatherColors.support;\n    aboutCloseBtnElm.style.borderColor = weatherColors.main;\n    copyrightElm.style.backgroundColor = weatherColors.main;\n    copyrightTextElm.style.color = weatherColors.support;\n\n    bodyElm.style.backgroundImage = `url('${bgImage.image}')`;\n    copyrightTextElm.innerHTML = `<p>Photo by <a href='${bgImage.credit.URL}'>${bgImage.credit.author}</a>, <a href='${bgImage.credit.licenseURL}'>${bgImage.credit.license}</a>.</p>`;\n\n    // set scale and switch handlers\n    if (userScale === 'celsius') toggleButtonsState(tempCScaleLabelElm, tempFScaleLabelElm);\n    else toggleButtonsState(tempFScaleLabelElm, tempCScaleLabelElm);\n\n    function cScaleClickHandler(e) {\n      if ((e.type === 'keypress' && (e.keyCode === 13 || e.keyCode === 32)) ||\n           e.type === 'click') {\n        tempElm.innerText = data.temp_c;\n        if (readCookie('scale')) eraseCookie('scale');\n        createCookie('scale','celsius',300)\n        toggleButtonsState(tempCScaleLabelElm, tempFScaleLabelElm);\n      }\n    }\n\n    function fScaleClickHandler(e) {\n      if ((e.type === 'keypress' && (e.keyCode === 13 || e.keyCode === 32)) ||\n           e.type === 'click') {\n        tempElm.innerText = data.temp_f;\n        if (readCookie('scale')) eraseCookie('scale');\n        createCookie('scale','fahrenheit',300)\n        toggleButtonsState(tempFScaleLabelElm, tempCScaleLabelElm);\n      }\n    }\n\n    function toggleButtonsState(btn_pressed, btn_released) {\n      if (btn_pressed.innerText  === 'F') {\n        var addHandler = cScaleClickHandler;\n        var removeHandler = fScaleClickHandler;\n        var inputCheckedElm = tempFScaleInputElm;\n        var inputUncheckedElm = tempCScaleInputElm;\n      } else if (btn_pressed.innerText  === 'C') {\n        var addHandler = fScaleClickHandler;\n        var removeHandler = cScaleClickHandler;\n        var inputCheckedElm = tempCScaleInputElm;\n        var inputUncheckedElm = tempFScaleInputElm;\n      }\n\n      btn_pressed.classList.add('vivid');\n      inputCheckedElm.setAttribute('aria-checked', 'true');\n      btn_pressed.removeEventListener('click', removeHandler);\n      btn_pressed.removeEventListener('keypress', removeHandler);\n\n      btn_released.classList.remove('vivid');\n      inputUncheckedElm.setAttribute('aria-checked', 'false');\n      btn_released.addEventListener('click', addHandler);\n      btn_released.addEventListener('keypress', addHandler);\n    }\n\n\n  }\n\n  function getWeatherForPosition(pos) {\n    //const httpAddr = `https://api.wunderground.com/api/c29706cb930a70b9/conditions/q/${pos.coords.latitude},${pos.coords.longitude}.json`;//Kenmore,WA\n    const httpAddr = `https://api.wunderground.com/api/c29706cb930a70b9/conditions/q/${pos}.json`;\n    if (!fetch) alert('fetch() unavailable');\n\n    fetch(httpAddr)\n      .then(resp => {\n        if (resp.ok) {\n          return resp.json();\n        }\n        throw new Error();\n      })\n      .then(data => {\n\n        const obz = data.current_observation;\n        const loc = obz.display_location;\n\n        const place = loc.city + ', ' + (loc.country === 'US' ? loc.state : loc.state_name) +  (loc.country === 'US' ? (', ' + loc.country) : '');\n        const time = obz.local_epoch;\n        let d = new Date(0);\n        d.setUTCSeconds(time);\n        const dayOptions = { weekday: 'long' };\n        const dateOptions = { month: 'long',\n                              day: 'numeric' };\n        const timeOptions = { hour: 'numeric',\n                              minute: 'numeric' };\n        const currDay = d.toLocaleDateString(undefined, dayOptions);\n        const currDate = d.toLocaleDateString(undefined, dateOptions);\n        const currTime = d.toLocaleTimeString(undefined, timeOptions);\n        const currMonth = d.getMonth() + 1;\n        const sky = obz.weather;\n        const temp = obz.temperature_string;\n        const temp_c = obz.temp_c;\n        const temp_f = obz.temp_f;\n        const tempFeels = obz.feelslike_string;\n        const tempFeelsC = obz.feelslike_c;\n        const tempFeelsF = obz.feelslike_f;\n        const conditions = obz.icon;\n        return {\n          place,\n          hemisphere: pos.split(',')[0] > 0 ? 'north' : 'south',\n          currDay,\n          currDate,\n          currTime,\n          currMonth,\n          sky,\n          temp,\n          temp_f,\n          temp_c,\n          tempFeels,\n          tempFeelsF,\n          tempFeelsC,\n          conditions\n        }\n      })\n      .then(data => displayData(data))\n      .catch (error => console.log(`Error while retrieving weather data - ${error.msg}`));\n  }\n\n  function getLocationByIP() {\n    fetch('https://freegeoip.net/json/')\n      .then(resp => {\n        if (resp.ok) return resp.json();\n        throw new Error();\n      })\n      .then(data => {\n        getWeatherForPosition(data.latitude + ',' + data.longitude);\n      })\n  }\n\n  function geoLocFail(error) {\n    let msg = '';\n    switch(error) {\n      case 1: //error.PERMISSION_DENIED:\n           msg = \"User denied the request for Geolocation.\";\n           break;\n      case 2: //error.POSITION_UNAVAILABLE:\n           msg = \"Location information is unavailable.\";\n           break;\n      case 3: //error.TIMEOUT:\n          msg = \"The request to get user location timed out.\";\n          break;\n      default:\n          msg = error.message;\n          break;\n    }\n    console.warn(`Error: ${msg}`);\n    getLocationByIP(); //fallback to get alternative user location;\n  }\n\n  function getLocation() {\n    if(navigator.geolocation) {\n      const location_timeout = setTimeout(function() {\n        let err = new Error({code: 3});\n        geoLocFail(err);\n      }, 0.2 * 10 * 1000); //0.2 is for 2 seconds timeout\n      navigator.geolocation.getCurrentPosition(function(position) {\n        clearTimeout(location_timeout);\n        //console.log('successfully get geoposition');\n        getWeatherForPosition(position.coords.latitude + ',' + position.coords.longitude);\n      }, function(err) {\n        clearTimeout(location_timeout);\n        //console.log('failed to get geoposition');\n        geoLocFail(err);\n      }, { timeout: 0.2 * 10 * 1000, maximumAge: 60 * 10 * 1000, enableHighAccuracy: false });\n    } else {\n      let err = new Error({code: -999, message: 'An unknown Geolocation error occurred'});\n      geoLocFail(err);\n    }\n  }\n\n// main\n  getLocation();\n\n  const aboutBtn = document.querySelector('.about__button');\n  aboutBtn.addEventListener('click', function() {\n    const aboutMsg = document.querySelector('.about');\n    aboutMsg.classList.toggle('closed');\n  });\n\n  const aboutCloseBtn = document.querySelector('.about__button--close-modal');\n  aboutCloseBtn.addEventListener('click', function() {\n    const aboutMsg = document.querySelector('.about');\n    aboutMsg.classList.toggle('closed');\n  });\n"],"sourceRoot":"/source/"}